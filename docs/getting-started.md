# Installing & Running nojs

> ⚠️ **Status:** nojs is an experimental MVP. The API may change before a stable release.

---

## Prerequisites

- **Go 1.25+** — [https://go.dev/dl/](https://go.dev/dl/)
- **Make** — pre-installed on Linux/macOS; on Windows use WSL
- **A static file server** — `python3 -m http.server` works fine, or any alternative

---

## Step 1 — Clone the repository

```bash
git clone https://github.com/ForgeLogic/nojs.git
cd nojs
```

---

## Step 2 — Copy the demo app as your starting point

The `app/` directory is a fully wired-up example application. It contains everything you need: the HTML shell, the WASM bootstrap files, a working `Makefile`, and example components. Copy it to a new location to use as your project scaffold:

```bash
cp -r app/ ~/projects/my-nojs-app
cd ~/projects/my-nojs-app
```

The copied directory has this structure:

```
my-nojs-app/
├── go.mod                          ← rename the module here
├── go.sum
├── internal/
│   └── app/
│       ├── main.go                 ← WASM entrypoint
│       ├── routes.go               ← route registration
│       └── components/             ← your components go here
│           └── pages/
│               └── ...
└── wwwroot/
    ├── index.html                  ← HTML shell (no changes needed)
    ├── core.js                     ← framework bootstrap (no changes needed)
    ├── wasm_exec.js                ← ⚠️ must be refreshed (see Step 3)
    └── main.wasm                   ← generated by `make wasm`
```

---

## Step 3 — Refresh `wasm_exec.js`

`wasm_exec.js` is the Go WASM runtime bridge and **must match your local Go version**. The copy in `app/wwwroot/` matches the version used during development and may be out of date.

Replace it with the one from your local Go installation:

```bash
cp "$(go env GOROOT)/misc/wasm/wasm_exec.js" ./wwwroot/
```

> ⚠️ Repeat this step any time you upgrade Go. A mismatched `wasm_exec.js` will silently fail to load the WASM module.

---

## Step 4 — Rename the module

Open `go.mod` and change the module path to match your project:

```
module github.com/YourOrg/your-app
```

Update any internal imports that reference `github.com/ForgeLogic/app` to use the new module path.

---

## Step 5 — Point at the framework modules

While nojs is in active development the modules are referenced via `replace` directives. Update `go.mod` to point at your local clone of the framework:

```
replace github.com/ForgeLogic/nojs => /path/to/nojs/nojs
replace github.com/ForgeLogic/nojs-router => /path/to/nojs/router
```

> **Note:** Once nojs is published to pkg.go.dev, you will be able to use `go get github.com/ForgeLogic/nojs@latest` and remove the `replace` directives.

---

## Step 6 — Build and run

```bash
# Compile templates + build WASM
make full

# Start the dev server (default: port 9090)
make serve
```

Open **http://localhost:9090** in your browser. The console should print `WebAssembly module loaded.`

> **Tip:** Enable **"Disable cache"** in DevTools → Network to ensure the WASM binary reloads on every refresh.

---

## Build command reference

| Command          | Description                                          |
|------------------|------------------------------------------------------|
| `make full`      | Compile templates + build WASM (development)         |
| `make full-prod` | Compile templates + build WASM (production/optimised)|
| `make wasm`      | Rebuild WASM only — fast refresh, skips templates    |
| `make serve`     | Start dev server on port 9090                        |
| `make clean`     | Remove generated `main.wasm`                         |

> **When to use `make wasm` vs `make full`:**  
> Use `make wasm` when you only changed `.go` files. Use `make full` when you created or modified any `.gt.html` template — templates must be recompiled before the WASM binary is built.

---

## Troubleshooting

| Symptom | Fix |
|---|---|
| `WebAssembly module loaded` not in console | Check that `wasm_exec.js` and `core.js` are in `wwwroot/` and included in `index.html` |
| Stale output after code changes | Rebuild with `make wasm` (or `make full` for template changes), then hard-refresh |
| `wasm_exec.js` errors after Go upgrade | Re-copy from `$(go env GOROOT)/misc/wasm/wasm_exec.js` |
| Exported Go function is `undefined` in JS | Ensure `main.go` registered it with `js.Global().Set(...)` and WASM was rebuilt |
| Template changes not reflected | Run `make full` — templates must be recompiled before `make wasm` |

---

## Next steps

- Read the [Quick Guide](guides/quick-guide.md) for a practical reference of all framework features
- Browse the example components in `app/internal/app/components/` to see working patterns
- Read the [NoJS Manifesto](design/manifesto.md) for the design philosophy behind the framework

> **Future:** A `nojs-starter` template repository is planned to replace the manual copy step above.
